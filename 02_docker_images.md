# Docker イメージ についてのメモ

## このパートの目的

- Docker イメージの概要と目的を理解しよう
- コンテナレジストリについて知ろう
 - コンテナレジストリの目的と、様々なオプションを知ろう
 - Docker Hub でのイメージの探し方を知ろう
- CLI で Docker イメージを管理しよう
- Dockerfile を作って image を build できるようになろう
- コンテナとイメージの違いを知ろう

## Docker イメージとは？

- コンテナの設計図
- 同じイメージを run したら、初期状態は必ず同じコンテナが出来上がる

### Docker イメージのレイヤー

- 設定
	- アプリケーションや環境の設定
- アプリケーションのコード
	- 稼働したいアプリケーション自体のコード or バイナリ
- ライブラリと依存関係
	- アプリケーションに必要なすべての外部コード
- ランタイムの環境
	- アプリケーションに必要なソフトウェア（Python, Node.js など）
- ベースレイヤー
	- OS(ubuntu, Alpine など)

コンテナのある時点の情報をフリーズしてイメージを作ることもできるが、諸々の理由で Dockerfile を使う方がおすすめ（理由は後述）

## Docker イメージの主な入手元

- Docker Hub 
 - Docker の公式なイメージレポジトリ
- プライベートレジストリ
 - 組織特有のイメージをストアする場合やエアギャップ環境などで、個別にレポジトリを作る
- 自分でイメージを作る

## コンテナレジストリ

なぜ必要なのか
- 共有のため
- バージョニング
- セキュリティ
- 自動化（CI/CDとの接続）

コンテナレジストリの種類
- パブリック（Docker Hub など）
- プライベート

## タグづけのコマンド

```
docker tag 手持ちのイメージ名:バージョン 別名のイメージ名:バージョン
```

## レポジトリに docker イメージを push する

`docker login` が完了した状態で以下を実施

```
docker tag 手持ちのイメージ名:バージョン dockerhubのユーザー名/イメージ名:バージョン
```

